= Create API models with API Designer
:page-sidebar: cockpit_sidebar
:page-permalink: cockpit/3.x/cockpit_userguide_api_designer.html
:page-folder: cockpit/user-guide

[label label-version]#New in version 3.15#

Been meaning to switch to Design First APIs for a while? Now's your chance! With API Designer's drag-and-drop, no-code approach, you can produce fully OpenAPI compliant API models in minutes.
Then, once you're happy with your design, you can export the model as an OpenAPI spec (OAS) in JSON format, or push the model to one of your linked APIM installations, where you can work with it like any other API.

image:cockpit/api-designer.png[]

API Designer consists of four sections:

- The left-hand pane, where you can specify the properties of your model.
- The central pane, where you can view and update a graphical view of your model.
- The right-hand pane, where you can view details of the finished model, including the API and OAS versions, Swagger documentation for your endpoints, and your API schema.
- The top bar, where you can update the API model settings, export the OAS, and deploy the API to APIM.

== Before you begin

Before you deploy an API model, you need to check the default environment in the Organization settings for API Designer, to ensure API Designer will deploy to the correct APIM environment.

== Create a new API model

. Click *API Designer*.
. On the *New model* tile, click the plus icon.
+
image:cockpit/new-model.png[Create a new model with API Designer from Gravitee]

. Select the organization from the list.
+
image:cockpit/model-test.png[Test API model in Gravitee Cockpit]

. Give your model a name. The context path is automatically created with the proper hyphenated naming convention. The context path must be unique for the organization.
. (Optional) Add a description for your API model.
. Click *CREATE*.
+
The drag-and-drop interface is loaded with some initial default attributes, for you to start adding the details of your model.
+
image:cockpit/api-designer-initial.png[]

=== Add API operations

To add an API operation:

. With the API node of the model selected, click the operation in the *Operations* section of the left-hand pane. You can choose from the full list of API CRUD operations available:

- *Search* creates a `/GET` operation that retrieves all instances of the API.
- *Read* creates a `/GET` operation that retrieves a specific instance by ID.
- *Delete* creates a `/DELETE` operation that deletes a specific instance by ID.
- *Create* creates a `/POST` operation that creates a new instance.
- *Update* creates a `/PUT` operation that updates a specific instance by ID.
- *Patch* creates a `/PATCH` operation that updates elements of a specific instance by ID.

. To add pagination query parameters to your operation, select the *Pagination* option.
. In the *Optional param* section, add any optional query parameters.
+
API Designer adds the related CRUD operation to the right-hand pane as Swagger documentation. Each new operation includes the currently defined attributes by default, as well as pagination query parameters if you enabled pagination, and any other optional query parameters you specified.
+
image:cockpit/api-designer-operations.png[]

=== Define API attributes

API Designer comes with a default `id` attribute and a generic example attribute called `an attribute`. You can update or delete these default attributes, and add your own attributes.

TIP: To delete an attribute, right-click on the node and select *Delete*.

To add a new attribute:

. Hover over the node where you want to add the attribute, until you see a plus icon on one or both sides of the node.
+
image:cockpit/api-designer-add-att.png[]
+
. If the node is:

- the API node, click the plus icon to the left or right to create an upstream or downstream attribute.
- an attribute node, click the plus icon to the right to create a child attribute.

. In the *Attribute* section of the left-hand pane, enter the attribute label and type. You can also enter the following optional values:
- *Description*: appears in the Swagger documentation and OAS descriptions.
- *Example*: appears in the Swagger documentation and OAS examples.
- *Comment*: an internal comment for your own usage.
. In the *Options* section, select the attribute options:
- *List*: the attribute is an array. Arrays are shown in the graphical representation between square brackets.
- *In Abstract*: you want the attribute to be returned in 200 responses.
- *Searchable*: you want the attribute to appear as a query parameter you can use to search for specific values.
. In the *Optional param* section, select additional options for the attribute. For example, if you want the attribute to appear in the Swagger documentation, select *In documentation*.
+
If you select this option, API Designer updates the Swagger documentation with details of the new attribute:
+
image:cockpit/api-designer-attributes.png[]

=== Try out your operation

In the right-hand pane, you can expand an operation to view the details of the spec, and click *Try it out* to test the operation.

You need to enter any required attribute values before you execute the operation (such as an ID for `PUT` operations), and you can also enter values for optional parameters, such as pagination values.

== Update the settings

You can specify which type of case to use for paths, schema attributes, and parameters. Cockpit automatically converts names based on the case you specify.

To update these settings, click the settings icon image:icons/api-designer-settings-icon.png[role="icon"] in the top bar.

== Export the OpenAPI spec

To export the OAS:

. Click the export icon image:icons/api-designer-export-icon.png[role="icon"] in the top bar.
. Open or save the file.
+
image:cockpit/export-oas.png[]

== Deploy the API model

You can choose between three different ways of deploying your model to APIM:

- Documented: Only the OAS for the API is published to APIM, it is not deployed on APIM Gateway or published in APIM Portal.
- Mocked: The API is published with a keyless plan and deployed on APIM Gateway with a link:/apim/3.x/apim_policies_mock.html[mock policy^], so consumers can retrieve mock responses from it.
- Published: The API is published with a keyless plan, deployed on APIM Gateway, and published in APIM Portal so consumers can subscribe to it.
+
link:/apim/3.x/apim_publisherguide_plans_subscriptions.html[Learn more about plans in APIM^]

To deploy the API model:

. Click the deploy icon image:icons/api-designer-deploy-icon.png[role="icon"] in the top bar.
. Choose the deployment mode.
. Click *Push* to push the model to APIM.
+
The API model is pushed to the APIM installation specified in Organization settings the deployment status changes to *Success*.
